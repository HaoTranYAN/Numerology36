{"version":3,"sources":["file:///Users/haothanhit/Desktop/ThanSoHocV2/Numerology36/assets/prefab/PrefabForecast.ts"],"names":["_decorator","Component","Node","Label","Sprite","RichText","Prefab","instantiate","color","sys","assetManager","TextAsset","AudioManager","CommonTS","Constant","TypeActionForecast","Languages","ccclass","property","PrefabForecast","isShowPrefabMonth","dayForecast","onLoad","initLayout","start","update","deltaTime","d","Date","dateNext","getFullYear","getMonth","getDate","dataUser","JSON","parse","localStorage","getItem","PERSONAL","personal","tinhPersonalDay","language","getLanguage","lblToday","string","lblTomorrow","url","loadData","showHideNodeMonth","playSoundClick","hideNodeMonth","imgArrowUpDown","node","angle","nodeParentForecast","getChildByName","removeFromParent","showNodeMonth","nodeMonth","prefabForecastMonth","name","insertChild","clickPreOrNext","event","customEventData","PRE","updateRichTextData","NEXT","type","number","checkNextNumber","console","log","self","bundle","getBundle","loadBundle","err","loadDir","texture","richTextDay","toString","load"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,Q,OAAAA,Q;AAAuBC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,G,OAAAA,G;AAAwBC,MAAAA,Y,OAAAA,Y;AAAcC,MAAAA,S,OAAAA,S;;AACrIC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,kB,iBAAAA,kB;;AACVC,MAAAA,S,iBAAAA,S;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBlB,U;;gCAIjBmB,c,WAFZF,OAAO,CAAC,gBAAD,C,UAIHC,QAAQ,CAACf,KAAD,C,UAGRe,QAAQ,CAACf,KAAD,C,UAMRe,QAAQ,CAACb,QAAD,C,UAIRa,QAAQ,CAACd,MAAD,C,UAOPc,QAAQ,CAAChB,IAAD,C,UAIRgB,QAAQ,CAACZ,MAAD,C,2BA5Bd,MAEaa,cAFb,SAEoClB,SAFpC,CAE8C;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAmBzCmB,iBAnByC,GAmBtB,KAnBsB;;AAAA;;AAAA;;AAAA,eA6BzCC,WA7ByC;AAAA;;AA+B1CC,QAAAA,MAAM,GAAE;AAEJ,eAAKC,UAAL;AAEH;;AACDC,QAAAA,KAAK,GAAG,CAEP;;AAGDC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AAGDH,QAAAA,UAAU,GAAE;AAGd;AAIM,cAAII,CAAC,GAAG,IAAIC,IAAJ,EAAR;AACA,cAAIC,QAAQ,GAAG,IAAID,IAAJ,CAASD,CAAC,CAACG,WAAF,EAAT,EAA0BH,CAAC,CAACI,QAAF,EAA1B,EAAwCJ,CAAC,CAACK,OAAF,KAAc,CAAtD,CAAf;AACA,cAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAW1B,GAAG,CAAC2B,YAAJ,CAAiBC,OAAjB,CAAyB;AAAA;AAAA,oCAASC,QAAlC,CAAX,CAAf,CATQ,CAUR;;AACA,cAAIC,QAAQ,GAAG;AAAA;AAAA,oCAASC,eAAT,CAAyBP,QAAzB,EAAmCN,CAAnC,CAAf;AACA,cAAIc,QAAQ,GAAG;AAAA;AAAA,sCAAUC,WAAV,EAAf;AAIA,eAAKC,QAAL,CAAcC,MAAd,GACAjB,CAAC,CAACK,OAAF,KAAc,GAAd,IAAqBL,CAAC,CAACI,QAAF,KAAe,CAApC,IAAyC,GAAzC,GAA+CJ,CAAC,CAACG,WAAF,EAD/C;AAEF,eAAKe,WAAL,CAAiBD,MAAjB,GAA0Bf,QAAQ,CAACG,OAAT,KAAqB,GAArB,IAA4BH,QAAQ,CAACE,QAAT,KAAsB,CAAlD,IAAuD,GAAvD,GAA6DF,QAAQ,CAACC,WAAT,EAAvF;AACA,eAAKT,WAAL,GAAmBkB,QAAQ,CAAClB,WAA5B;AACA,cAAIyB,GAAG,GAAGL,QAAQ,GAAG,eAAX,GAA6B,KAAKpB,WAA5C;AAGE,eAAK0B,QAAL,CAAcD,GAAd;AAIH;;AAIDE,QAAAA,iBAAiB,GAAE;AACjB;AAAA;AAAA,4CAAaC,cAAb,GADiB,CAIlB;AACA;;AAIDC,QAAAA,aAAa,GAAE;AACX,eAAK9B,iBAAL,GAAuB,KAAvB;AAEA,eAAK+B,cAAL,CAAoBC,IAApB,CAAyBC,KAAzB,GAA+B,CAA/B;AAEA,cAAID,IAAI,GAAG,KAAKE,kBAAL,CAAwBC,cAAxB,CAAuC,eAAvC,CAAX;;AACA,cAAIH,IAAI,IAAI,IAAZ,EAAkB;AAChBA,YAAAA,IAAI,CAACI,gBAAL;AACD,WARU,CAcf;;AAEC;;AAEDC,QAAAA,aAAa,GAAE;AACX,eAAKrC,iBAAL,GAAuB,IAAvB;AACA,eAAK+B,cAAL,CAAoBC,IAApB,CAAyBC,KAAzB,GAA+B,GAA/B;AAEA,cAAIK,SAAS,GAAGnD,WAAW,CAAC,KAAKoD,mBAAN,CAA3B;AACAD,UAAAA,SAAS,CAACE,IAAV,GAAiB,eAAjB;AACA,eAAKN,kBAAL,CAAwBO,WAAxB,CAAoCH,SAApC,EAA8C,CAA9C;AAEH;;AAGDI,QAAAA,cAAc,CAACC,KAAD,EAAQC,eAAR,EAAwB;AAElC;AAAA;AAAA,4CAAaf,cAAb;;AAEA,cAAGe,eAAe,IAAE;AAAA;AAAA,wDAAmBC,GAAvC,EAA2C;AACvC,iBAAKtB,QAAL,CAAcnC,KAAd,GAAsBA,KAAK,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAA3B;AACA,iBAAKqC,WAAL,CAAiBrC,KAAjB,GAAyBA,KAAK,CAAC,CAAD,EAAI,CAAJ,EAAO,EAAP,CAA9B;AACA,iBAAK0D,kBAAL,CAAwBF,eAAxB;AAEH,WALD,MAKM,IAAGA,eAAe,IAAE;AAAA;AAAA,wDAAmBG,IAAvC,EAA4C;AAE9C,iBAAKtB,WAAL,CAAiBrC,KAAjB,GAAyBA,KAAK,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAA9B;AACA,iBAAKmC,QAAL,CAAcnC,KAAd,GAAsBA,KAAK,CAAC,CAAD,EAAI,CAAJ,EAAO,EAAP,CAA3B;AACA,iBAAK0D,kBAAL,CAAwBF,eAAxB;AACH;AAIJ;;AAGDE,QAAAA,kBAAkB,CAACE,IAAD,EAA0B;AACxC,cAAItB,GAAG,GAAG,EAAV;AACA,cAAIL,QAAQ,GAAG;AAAA;AAAA,sCAAUC,WAAV,EAAf;AACA,cAAI2B,MAAM,GAAG,CAAb;;AACA,cAAID,IAAI,IAAI;AAAA;AAAA,wDAAmBH,GAA/B,EAAoC;AAChCI,YAAAA,MAAM,GAAG,KAAKhD,WAAd;AACH,WAFD,MAEO,IAAG+C,IAAI,IAAI;AAAA;AAAA,wDAAmBD,IAA9B,EAAoC;AACvCE,YAAAA,MAAM,GAAG,KAAKC,eAAL,CAAqB,KAAKjD,WAAL,GAAmB,CAAxC,CAAT;AACH;;AACDyB,UAAAA,GAAG,GAAGL,QAAQ,GAAG,eAAX,GAA6B4B,MAAnC;AACEE,UAAAA,OAAO,CAACC,GAAR,CAAY,aAAaH,MAAzB;AAEA,eAAKtB,QAAL,CAAcD,GAAd;AAEL;;AACDwB,QAAAA,eAAe,CAACD,MAAD,EAAS;AACpB,cAAIA,MAAM,GAAG,CAAb,EAAgB;AACdA,YAAAA,MAAM,GAAG,CAAT;AACD;;AACD,iBAAOA,MAAP;AACD;AAGD;AACN;AACA;AACA;AACA;AACA;;;AACEtB,QAAAA,QAAQ,CAACD,GAAD,EAAM;AACZ,cAAI2B,IAAI,GAAC,IAAT;AACA,cAAIC,MAAM,GAAGhE,YAAY,CAACiE,SAAb,CAAuB,MAAvB,CAAb;;AAEA,cAAID,MAAM,IAAI,IAAd,EAAoB;AAClBhE,YAAAA,YAAY,CAACkE,UAAb,CAAwB,MAAxB,EAAgC,CAACC,GAAD,EAAMH,MAAN,KAAiB;AAI/CA,cAAAA,MAAM,CAACI,OAAP,CAAehC,GAAf,EAAoBnC,SAApB,EAA+B,UAAUkE,GAAV,EAAeE,OAAf,EAAwB;AAErDN,gBAAAA,IAAI,CAACO,WAAL,CAAiBpC,MAAjB,GAA0B,kBAAiBmC,OAAO,CAACE,QAAR,EAAmB,UAA9D;AAID,eAND;AAOD,aAXD;AAYD,WAbD,MAaO;AAEHP,YAAAA,MAAM,CAACQ,IAAP,CAAYpC,GAAZ,EAAiBnC,SAAjB,EAA4B,UAAUkE,GAAV,EAAeE,OAAf,EAAwB;AAClD;AACAN,cAAAA,IAAI,CAACO,WAAL,CAAiBpC,MAAjB,GAA0B,kBAAiBmC,OAAO,CAACE,QAAR,EAAmB,UAA9D;AAED,aAJD;AAKH;AAKF;;AAlM2C,O;;;;;iBAGxB,I;;;;;;;iBAGG,I;;;;;;;iBAMG,I;;;;;;;iBAIC,I;;;;;;;iBAOG,I;;;;;;;iBAIU,I","sourcesContent":["import { _decorator, Component, Node, Label, Sprite, RichText, SpriteFrame, Prefab, instantiate, color, sys, native, resources, assetManager, TextAsset } from 'cc';\nimport { AudioManager } from '../common/AudioManager';\nimport { CommonTS } from '../common/CommonTS';\nimport { Constant, TypeActionForecast } from '../common/Constant';\nimport { Languages } from '../common/Language';\nconst { ccclass, property } = _decorator;\n\n@ccclass('PrefabForecast')\n\nexport class PrefabForecast extends Component {\n\n    @property(Label)\n    lblToday: Label = null;\n\n    @property(Label)\n    lblTomorrow: Label = null;\n\n\n\n\n    @property(RichText)\n    richTextDay: RichText = null;\n\n\n    @property(Sprite)\n    imgArrowUpDown: Sprite = null;\n    \n\n     isShowPrefabMonth =false;\n\n\n     @property(Node)\n     nodeParentForecast: Node = null;\n \n\n     @property(Prefab)\n     prefabForecastMonth: Prefab | null = null;\n   \n     dayForecast: number;\n\n    onLoad(){\n    \n        this.initLayout()\n\n    }\n    start() {\n\n    }\n\n\n    update(deltaTime: number) {\n        \n    }\n\n\n    initLayout(){\n\n\n  //      this.hideNodeMonth()\n\n\n\n        var d = new Date();\n        var dateNext = new Date(d.getFullYear(), d.getMonth(), d.getDate() + 1);\n        var dataUser = JSON.parse(sys.localStorage.getItem(Constant.PERSONAL));\n        ////console.log(dataUser);\n        var personal = CommonTS.tinhPersonalDay(dataUser, d);\n        var language = Languages.getLanguage();\n      \n\n\n        this.lblToday.string =\n        d.getDate() + \"/\" + (d.getMonth() + 1) + \"/\" + d.getFullYear();\n      this.lblTomorrow.string = dateNext.getDate() + \"/\" + (dateNext.getMonth() + 1) + \"/\" + dateNext.getFullYear();\n      this.dayForecast = personal.dayForecast;\n      var url = language + \"_daypersonal_\" + this.dayForecast;\n\n\n        this.loadData(url);\n\n\n        \n    }\n\n\n\n    showHideNodeMonth(){\n      AudioManager.playSoundClick()\n\n\n     //   this.isShowPrefabMonth ? this.hideNodeMonth() : this.showNodeMonth()\n    }\n\n\n\n    hideNodeMonth(){\n        this.isShowPrefabMonth=false\n    \n        this.imgArrowUpDown.node.angle=0\n\n        var node = this.nodeParentForecast.getChildByName(\"monthForecast\");\n        if (node != null) {\n          node.removeFromParent();\n        }\n\n\n\n\n\n    // this.imgArrowUpDown.getComponent(Sprite).spriteFrame= AudioManager.getMusic()===\"true\"? this.icON : this.icOFF\n\n    }\n\n    showNodeMonth(){\n        this.isShowPrefabMonth=true\n        this.imgArrowUpDown.node.angle=180\n\n        var nodeMonth = instantiate(this.prefabForecastMonth);\n        nodeMonth.name = \"monthForecast\";\n        this.nodeParentForecast.insertChild(nodeMonth,1)\n\n    }\n\n\n    clickPreOrNext(event, customEventData){\n\n        AudioManager.playSoundClick()\n\n        if(customEventData==TypeActionForecast.PRE){\n            this.lblToday.color = color(255, 255, 255);\n            this.lblTomorrow.color = color(5, 4, 44);\n            this.updateRichTextData(customEventData);\n\n        }else if(customEventData==TypeActionForecast.NEXT){\n\n            this.lblTomorrow.color = color(255, 255, 255);\n            this.lblToday.color = color(5, 4, 44);\n            this.updateRichTextData(customEventData);\n        }\n        \n\n\n    }\n\n\n    updateRichTextData(type: TypeActionForecast){\n        var url = \"\";\n        var language = Languages.getLanguage();\n        var number = 0;\n        if (type == TypeActionForecast.PRE) {\n            number = this.dayForecast;\n        } else if(type == TypeActionForecast.NEXT) {\n            number = this.checkNextNumber(this.dayForecast + 1);\n        }\n        url = language + \"_daypersonal_\" + number;\n          console.log(\"number: \" + number);\n\n          this.loadData(url);\n\n    }\n    checkNextNumber(number) {\n        if (number > 9) {\n          number = 1;\n        }\n        return number;\n      }\n\n  \n      /**\n   * Hàm load Data từ bundle\n   * @param numberDay: Tên con số cần lấy (Đánh số theo thứ tự từ 1-9)\n   * @param nameBundle : Tên bundle chứa\n   * @result : Nội dung về con số tương ứng \n   */\n  loadData(url) {\n    var self=this\n    var bundle = assetManager.getBundle(\"data\");\n\n    if (bundle == null) {\n      assetManager.loadBundle(\"data\", (err, bundle) => {\n  \n\n        \n        bundle.loadDir(url, TextAsset, function (err, texture) {\n\n          self.richTextDay.string =`<color=#000000>${texture.toString()}</color>`;\n\n\n\n        });\n      });\n    } else {\n\n        bundle.load(url, TextAsset, function (err, texture) {\n          ////console.log(texture)\n          self.richTextDay.string =`<color=#000000>${texture.toString()}</color>`;\n\n        });\n    }\n\n\n\n\n  }\n\n}\n\n"]}