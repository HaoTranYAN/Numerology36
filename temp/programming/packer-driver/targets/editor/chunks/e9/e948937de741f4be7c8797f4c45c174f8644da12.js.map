{"version":3,"sources":["file:///Users/haothanhit/Desktop/ThanSoHocV2/Numerology36/assets/prefab/PrefabForecastMonth.ts"],"names":["_decorator","Component","Label","RichText","color","sys","assetManager","TextAsset","AudioManager","CommonTS","Constant","TypeActionForecast","Languages","ccclass","property","PrefabForecastMonth","monthForecast","onLoad","initLayout","start","update","deltaTime","clickPreOrNext","event","customEventData","playSoundClick","PRE","lblMonth","lblNextMonth","updateRichTextData","NEXT","type","url","language","getLanguage","number","checkNextNumber","console","log","loadData","d","Date","dateNext","getFullYear","getMonth","getDate","dataUser","JSON","parse","localStorage","getItem","PERSONAL","personal","tinhPersonalDay","string","nextMonth","year","bundle","getBundle","loadBundle","err","loadDir","texture","richTextMonth","toString","load"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Label, Sprite, RichText, SpriteFrame, color, sys, assetManager, TextAsset, native } from 'cc';\nimport { AudioManager } from '../common/AudioManager';\nimport { CommonTS } from '../common/CommonTS';\nimport { Constant, TypeActionForecast } from '../common/Constant';\nimport { Languages } from '../common/Language';\nconst { ccclass, property } = _decorator;\n\n@ccclass('PrefabForecastMonth')\n\nexport class PrefabForecastMonth extends Component {\n\n    @property(Label)\n    lblMonth: Label = null;\n\n    @property(Label)\n    lblNextMonth: Label = null;\n\n    @property(RichText)\n    richTextMonth: RichText = null;\n\n    monthForecast: number;\n\n   \n\n    onLoad(){\n    \n        this.initLayout()\n\n    }\n    start() {\n\n    }\n\n\n    update(deltaTime: number) {\n        \n    }\n\n    clickPreOrNext(event, customEventData){\n\n        AudioManager.playSoundClick()\n\n        if(customEventData==TypeActionForecast.PRE){\n            this.lblMonth.color = color(255, 255, 255);\n            this.lblNextMonth.color = color(5, 4, 44);\n            this.updateRichTextData(customEventData);\n\n        }else if(customEventData==TypeActionForecast.NEXT){\n\n            this.lblNextMonth.color = color(255, 255, 255);\n            this.lblMonth.color = color(5, 4, 44);\n            this.updateRichTextData(customEventData);\n        }\n        \n\n\n    }\n\n\n    updateRichTextData(type: TypeActionForecast){\n        var url = \"\";\n        var language = Languages.getLanguage();\n        var number = 0;\n        if (type == TypeActionForecast.PRE) {\n            number = this.monthForecast;\n          } else if(type == TypeActionForecast.NEXT) {\n            number = this.checkNextNumber(this.monthForecast + 1);\n          }\n          url = language + \"_monthpersonal_\" + number;\n          console.log(\"number: \" + number);\n          this.loadData(url);\n\n    }\n    checkNextNumber(number) {\n        if (number > 9) {\n          number = 1;\n        }\n        return number;\n      }\n\n    initLayout(){\n\n\n        var d = new Date();\n        var dateNext = new Date(d.getFullYear(), d.getMonth(), d.getDate() + 1);\n        var dataUser = JSON.parse(sys.localStorage.getItem(Constant.PERSONAL));\n        ////console.log(dataUser);\n        var personal = CommonTS.tinhPersonalDay(dataUser, d);\n        var language = Languages.getLanguage();\n      \n\n\n        this.lblMonth.string = d.getMonth() + 1 + \"/\" + d.getFullYear();\n        var nextMonth = d.getMonth() + 2;\n        var year = d.getFullYear();\n        if (nextMonth > 12) {\n          nextMonth = 1;\n          year = year + 1;\n        }\n        this.lblNextMonth.string = nextMonth + \"/\" + year;\n        //url = language + \"/ThangCaNhan/\" + personal.monthForecast;\n        this.monthForecast = personal.monthForecast;\n        var url = language + \"_monthpersonal_\" + this.monthForecast;\n        this.loadData(url);\n\n\n        \n    }\n\n      /**\n   * Hàm load Data từ bundle\n   * @param numberDay: Tên con số cần lấy (Đánh số theo thứ tự từ 1-9)\n   * @param nameBundle : Tên bundle chứa\n   * @result : Nội dung về con số tương ứng \n   */\n  loadData(url) {\n    var bundle = assetManager.getBundle(\"data\");\n\n    if (bundle == null) {\n      assetManager.loadBundle(\"data\", (err, bundle) => {\n  \n        \n        bundle.loadDir(url, TextAsset, function (err, texture) {\n\n          (this as PrefabForecastMonth).richTextMonth.string = texture.toString();\n\n\n\n        });\n      });\n    } else {\n        bundle.load(url, TextAsset, function (err, texture) {\n          ////console.log(texture)\n          (this as PrefabForecastMonth).richTextMonth.string = texture.toString();\n\n        });\n    }\n\n  }\n\n\n\n  \n}\n\n"]}