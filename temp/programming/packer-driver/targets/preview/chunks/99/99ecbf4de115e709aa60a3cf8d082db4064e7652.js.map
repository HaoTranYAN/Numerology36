{"version":3,"sources":["file:///Users/haothanhit/Desktop/ThanSoHocV2/Numerology36/assets/common/AudioManager.ts"],"names":["AudioManager","assert","assetManager","AudioClip","log","sys","SOUND","MUSIC","init","audioSource","_audioSource","initSound","_audioSourceSound","playMusic","play","isMusicOn","playing","checkPlayMusic","getMusic","pauseMusic","pause","playSoundClick","getSound","playSound","setMusic","state","localStorage","setItem","sound","getItem","setSound","name","path","cachedAudioClip","_cachedAudioClipMap","playOneShot","resources","load","err","clip","console","warn"],"mappings":"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","sourcesContent":["import { assert, assetManager, AudioClip, AudioSource, log, sys } from \"cc\";\n\nconst SOUND = \"SOUND\";\nconst MUSIC = \"MUSIC\";\n\nexport class AudioManager {\n  private static _audioSource?: AudioSource;\n  private static _cachedAudioClipMap: Record<string, AudioClip> = {};\n  private static _audioSourceSound?: AudioSource;\n\n  // init AudioManager in GameRoot component.\n  public static init(audioSource: AudioSource) {\n    log(\"Init AudioManager !\");\n    AudioManager._audioSource = audioSource;\n  }\n\n   // init Sound in GameRoot component.\n   public static initSound(audioSource: AudioSource) {\n    log(\"Init AudioManager !\");\n    AudioManager._audioSourceSound = audioSource;\n  }\n\n  public static playMusic() {\n    const audioSource = AudioManager._audioSource!;\n    assert(audioSource, \"AudioManager not inited!\");\n\n    audioSource.play();\n  }\n\n  public static isMusicOn(): boolean {\n    return AudioManager._audioSource.playing;\n  }\n\n  public static checkPlayMusic() {\n    if (this.getMusic() === \"true\" && !this.isMusicOn()) {\n      this.playMusic();\n    }\n  }\n\n  public static pauseMusic() {\n    const audioSource = AudioManager._audioSource!;\n    assert(audioSource, \"AudioManager not inited!\");\n\n    audioSource.pause();\n  }\n\n  public static playSoundClick() {\n    if (this.getSound() === \"true\") {\n      this.playSound(\"click\");\n    }\n  }\n\n  public static setMusic(state: string) {\n    sys.localStorage.setItem(MUSIC, state);\n  }\n\n  public static getMusic(): string {\n    var sound: any = sys.localStorage.getItem(MUSIC);\n    return sound ?? \"true\";\n  }\n\n  public static setSound(state: string) {\n    sys.localStorage.setItem(SOUND, state);\n  }\n\n  public static getSound(): string {\n    var sound: any = sys.localStorage.getItem(SOUND);\n    return sound ?? \"true\";\n  }\n\n  public static playSound(name: string) {\n    const audioSource = AudioManager._audioSource!;\n    assert(audioSource, \"AudioManager not inited!\");\n\n    const path = `sound/${name}`;\n    let cachedAudioClip = AudioManager._cachedAudioClipMap[path];\n    if (cachedAudioClip) {\n      audioSource.playOneShot(cachedAudioClip, 1);\n    } else {\n      assetManager.resources?.load(path, AudioClip, (err, clip) => {\n        if (err) {\n          console.warn(err);\n          return;\n        }\n\n        AudioManager._cachedAudioClipMap[path] = clip;\n        audioSource.playOneShot(clip, 1);\n      });\n    }\n  }\n}\n"]}