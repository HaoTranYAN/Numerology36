{"version":3,"sources":["file:///Users/haothanhit/Desktop/ThanSoHocV2/Numerology36/assets/prefab/PrefabForecast.ts"],"names":["_decorator","Component","Node","Label","Sprite","RichText","Prefab","instantiate","color","sys","resources","AudioManager","CommonTS","Constant","TypeActionForecast","Languages","ccclass","property","PrefabForecast","isShowPrefabMonth","dayForecast","onLoad","initLayout","start","update","deltaTime","hideNodeMonth","d","Date","dateNext","getFullYear","getMonth","getDate","dataUser","JSON","parse","localStorage","getItem","PERSONAL","personal","tinhPersonalDay","language","getLanguage","lblToday","string","lblTomorrow","url","loadData","showHideNodeMonth","showNodeMonth","imgArrowUpDown","node","angle","nodeParentForecast","getChildByName","removeFromParent","nodeMonth","prefabForecastMonth","name","insertChild","clickPreOrNext","event","customEventData","playSoundClick","PRE","updateRichTextData","NEXT","type","number","checkNextNumber","console","log","load","err","file","richTextDay","toString"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Label, Sprite, RichText, SpriteFrame, Prefab, instantiate, color, sys, native, resources } from 'cc';\nimport { AudioManager } from '../common/AudioManager';\nimport { CommonTS } from '../common/CommonTS';\nimport { Constant, TypeActionForecast } from '../common/Constant';\nimport { Languages } from '../common/Language';\nconst { ccclass, property } = _decorator;\n\n@ccclass('PrefabForecast')\n\nexport class PrefabForecast extends Component {\n\n    @property(Label)\n    lblToday: Label = null;\n\n    @property(Label)\n    lblTomorrow: Label = null;\n\n\n\n\n    @property(RichText)\n    richTextDay: RichText = null;\n\n\n    @property(Sprite)\n    imgArrowUpDown: Sprite = null;\n    \n\n     isShowPrefabMonth =false;\n\n\n     @property(Node)\n     nodeParentForecast: Node = null;\n \n\n     @property(Prefab)\n     prefabForecastMonth: Prefab | null = null;\n   \n     dayForecast: number;\n\n    onLoad(){\n    \n        this.initLayout()\n\n    }\n    start() {\n\n    }\n\n\n    update(deltaTime: number) {\n        \n    }\n\n\n    initLayout(){\n\n\n        this.hideNodeMonth()\n\n\n\n        var d = new Date();\n        var dateNext = new Date(d.getFullYear(), d.getMonth(), d.getDate() + 1);\n        var dataUser = JSON.parse(sys.localStorage.getItem(Constant.PERSONAL));\n        ////console.log(dataUser);\n        var personal = CommonTS.tinhPersonalDay(dataUser, d);\n        var language = Languages.getLanguage();\n      \n\n\n        this.lblToday.string =\n        d.getDate() + \"/\" + (d.getMonth() + 1) + \"/\" + d.getFullYear();\n      this.lblTomorrow.string = dateNext.getDate() + \"/\" + (dateNext.getMonth() + 1) + \"/\" + dateNext.getFullYear();\n      this.dayForecast = personal.dayForecast;\n      var url = language + \"_daypersonal_\" + this.dayForecast;\n\n\n        this.loadData(url);\n\n\n        \n    }\n\n\n\n    showHideNodeMonth(){\n\n        this.isShowPrefabMonth ? this.hideNodeMonth() : this.showNodeMonth()\n    }\n\n\n\n    hideNodeMonth(){\n        this.isShowPrefabMonth=false\n    \n        this.imgArrowUpDown.node.angle=0\n\n        var node = this.nodeParentForecast.getChildByName(\"monthForecast\");\n        if (node != null) {\n          node.removeFromParent();\n        }\n\n\n\n\n\n    // this.imgArrowUpDown.getComponent(Sprite).spriteFrame= AudioManager.getMusic()===\"true\"? this.icON : this.icOFF\n\n    }\n\n    showNodeMonth(){\n        this.isShowPrefabMonth=true\n        this.imgArrowUpDown.node.angle=180\n\n        var nodeMonth = instantiate(this.prefabForecastMonth);\n        nodeMonth.name = \"monthForecast\";\n        this.nodeParentForecast.insertChild(nodeMonth,1)\n\n    }\n\n\n    clickPreOrNext(event, customEventData){\n\n        AudioManager.playSoundClick()\n\n        if(customEventData==TypeActionForecast.PRE){\n            this.lblToday.color = color(255, 255, 255);\n            this.lblTomorrow.color = color(5, 4, 44);\n            this.updateRichTextData(customEventData);\n\n        }else if(customEventData==TypeActionForecast.NEXT){\n\n            this.lblTomorrow.color = color(255, 255, 255);\n            this.lblToday.color = color(5, 4, 44);\n            this.updateRichTextData(customEventData);\n        }\n        \n\n\n    }\n\n\n    updateRichTextData(type: TypeActionForecast){\n        var url = \"\";\n        var language = Languages.getLanguage();\n        var number = 0;\n        if (type == TypeActionForecast.PRE) {\n            number = this.dayForecast;\n        } else if(type == TypeActionForecast.NEXT) {\n            number = this.checkNextNumber(this.dayForecast + 1);\n        }\n        url = language + \"_daypersonal_\" + number;\n          console.log(\"number: \" + number);\n\n          this.loadData(url);\n\n    }\n    checkNextNumber(number) {\n        if (number > 9) {\n          number = 1;\n        }\n        return number;\n      }\n\n  \n      /**\n   * Hàm load Data từ bundle\n   * @param numberDay: Tên con số cần lấy (Đánh số theo thứ tự từ 1-9)\n   * @param nameBundle : Tên bundle chứa\n   * @result : Nội dung về con số tương ứng \n   */\n  loadData(url) {\n    // var bundle = assetManager.getBundle(\"Data\");\n\n    // if (bundle == null) {\n    //   assetManager.loadBundle(\"Data\", (err, bundle) => {\n    //     bundle.load(url, TextAsset, function (err, texture) {\n    //       this.richTextMonth.string = texture.toString();\n    //     });\n    //   });\n    // } else {\n    //     bundle.load(url, TextAsset, function (err, texture) {\n    //       ////console.log(texture)\n    //       this.richTextMonth.string = texture.toString();\n    //     });\n    // }\n\n    // this.richTextDay.string = native.fileUtils.getStringFromFile(\"../data/\"+url);\n\n    resources.load(\"data/\"+url, function (err, file) {\n        this.richTextDay.string = file.toString()\n    });\n\n  }\n\n}\n\n"]}